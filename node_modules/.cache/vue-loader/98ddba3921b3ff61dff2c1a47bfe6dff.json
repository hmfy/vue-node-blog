{"remainingRequest":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Learn\\blog-person\\src\\views\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Learn\\blog-person\\src\\views\\Login.vue","mtime":1578504681962},{"path":"D:\\Learn\\blog-person\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572976728968},{"path":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js","mtime":1577118252216}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGUsIG1hcEdldHRlcnN9IGZyb20gInZ1ZXgiCmltcG9ydCB7c2V0U3RvcmFnZUxvZ2lufSBmcm9tICIuLi9hc3NldHMvanMvdXRpbCI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiTG9naW4iLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB1c2VyOiAiIiwKICAgICAgICAgICAgcGFzc3dvcmQ6ICIiCiAgICAgICAgfQogICAgfSwKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgLi4ubWFwU3RhdGUoWyJpc0xvZ2luIl0pLAogICAgICAgIC4uLm1hcEdldHRlcnMoewogICAgICAgICAgICBwaG9uZTogImdldERldmljZUlzUGhvbmUiCiAgICAgICAgfSkKICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgZ2V0TG9naW4gKCl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLmF4aW9zKHsKICAgICAgICAgICAgICAgIHVybDogJy9sb2dpbicsCiAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICB1c2VyOiB0aGlzLnVzZXIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIHN1Ym1pdEZvcm0oKSB7CiAgICAgICAgICAgIGlmICh0aGlzLmlzTG9naW4pIHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygi5b2T5YmN5Li655m76ZmG54q25oCBLOivt+WLv+mHjeWkjeeZu+mZhiEiKTsKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHRoaXMuZ2V0TG9naW4oKTsKICAgICAgICAgICAgY29uc3QgcGFzc3dvcmQgPSByZXMuZGF0YVswXS5sZW5ndGggJiYgcmVzLmRhdGFbMF1bMF0ucGFzc3dvcmQ7CiAgICAgICAgICAgIGlmIChwYXNzd29yZCAmJiBwYXNzd29yZCA9PT0gdGhpcy5wYXNzd29yZCkgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfnmbvpmYbmiJDlip8hJyk7CiAgICAgICAgICAgICAgICAvKiDlhpnlhaVzZXNzaW9uU3RvcmFnZSAqLwogICAgICAgICAgICAgICAgY29uc3Qge3VzZXIsIHB3ZH0gPSB7dXNlcjogdGhpcy51c2VyLCBwYXNzd29yZH07CiAgICAgICAgICAgICAgICBzZXRTdG9yYWdlTG9naW4odXNlciwgcHdkKTsKCiAgICAgICAgICAgICAgICAvKiDmlLnlj5h2dWV455m76ZmG54q25oCBLOS+v+S6juWQjumdouafpeeciyjml6DpnIDlho3mr4/mrKHku45zZXNzaW9uU3RvcmFnZeaLvykgKi8KICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0TG9naW4iLCB0cnVlKTsKCiAgICAgICAgICAgICAgICAvLyDmuIXnqbrovpPlhaXmoYYKICAgICAgICAgICAgICAgIHRoaXMudXNlciA9ICIiOwogICAgICAgICAgICAgICAgdGhpcy5wYXNzd29yZCA9ICIiOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6LSm5Y+35a+G56CB6ZSZ6K+vJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG91dExvZ2luKCkgewogICAgICAgICAgICB0aGlzLiRjb25maXJtKCfnoa7lrprpgIDlh7rnmbvpmYblkJc/JywgJ+a4qemmqOaPkOekuicsIHsKICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKTsgLy8g5riF6Zmkc2Vzc2lvblN0b3JhZ2XnvJPlrZgKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0TG9naW4iLCBmYWxzZSk7IC8vIOmHjee9rnZ1ZXjnirbmgIEKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygn5b2T5YmN6LSm5Y+35bey6YCA5Ye6IScpOwogICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmluZm8oJ+W3suWPlua2iCcpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZCgpIHsKICAgICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJHN0b3JlOwogICAgICAgIHN0b3JlLmNvbW1pdCgic2V0TGVmdFRhZ3NMaW5lIiwgewogICAgICAgICAgICBsZWZ0Q29sOiB0aGlzLnBob25lID8gMjQgOiA4CiAgICAgICAgfSk7CiAgICB9Cn0K"},{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <el-form label-position=\"top\" label-width=\"80px\">\r\n        <el-form-item label=\"账号\">\r\n            <el-input clearable v-model=\"user\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\">\r\n            <el-input clearable show-password v-model=\"password\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item>\r\n            <el-button @click=\"submitForm\" type=\"primary\" class=\"phone-margin\">登陆</el-button>\r\n            <transition name=\"el-fade-in-linear\">\r\n                <el-button @click=\"outLogin\" type=\"danger\" v-if=\"isLogin\">退出登陆</el-button>\r\n            </transition>\r\n        </el-form-item>\r\n    </el-form>\r\n</template>\r\n\r\n<script>\r\n    import {mapState, mapGetters} from \"vuex\"\r\n    import {setStorageLogin} from \"../assets/js/util\";\r\n\r\n    export default {\r\n        name: \"Login\",\r\n        data() {\r\n            return {\r\n                user: \"\",\r\n                password: \"\"\r\n            }\r\n        },\r\n        computed: {\r\n            ...mapState([\"isLogin\"]),\r\n            ...mapGetters({\r\n                phone: \"getDeviceIsPhone\"\r\n            })\r\n        },\r\n        methods: {\r\n            getLogin (){\r\n                return this.axios({\r\n                    url: '/login',\r\n                    params: {\r\n                        user: this.user\r\n                    }\r\n                })\r\n            },\r\n            async submitForm() {\r\n                if (this.isLogin) {\r\n                    this.$message.warning(\"当前为登陆状态,请勿重复登陆!\");\r\n                    return\r\n                }\r\n                const res = await this.getLogin();\r\n                const password = res.data[0].length && res.data[0][0].password;\r\n                if (password && password === this.password) {\r\n                    this.$message.success('登陆成功!');\r\n                    /* 写入sessionStorage */\r\n                    const {user, pwd} = {user: this.user, password};\r\n                    setStorageLogin(user, pwd);\r\n\r\n                    /* 改变vuex登陆状态,便于后面查看(无需再每次从sessionStorage拿) */\r\n                    this.$store.commit(\"setLogin\", true);\r\n\r\n                    // 清空输入框\r\n                    this.user = \"\";\r\n                    this.password = \"\";\r\n                } else {\r\n                    this.$message.error('账号密码错误');\r\n                }\r\n            },\r\n            outLogin() {\r\n                this.$confirm('确定退出登陆吗?', '温馨提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    sessionStorage.clear(); // 清除sessionStorage缓存\r\n                    this.$store.commit(\"setLogin\", false); // 重置vuex状态\r\n                    this.$message.warning('当前账号已退出!');\r\n                }).catch(() => {\r\n                    this.$message.info('已取消');\r\n                });\r\n            }\r\n        },\r\n        created() {\r\n            const store = this.$store;\r\n            store.commit(\"setLeftTagsLine\", {\r\n                leftCol: this.phone ? 24 : 8\r\n            });\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]}]}