{"remainingRequest":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Learn\\blog-person\\src\\views\\TimeLine.vue?vue&type=style&index=0&id=e1907bca&scoped=true&lang=css&","dependencies":[{"path":"D:\\Learn\\blog-person\\src\\views\\TimeLine.vue","mtime":1578506982915},{"path":"D:\\Learn\\blog-person\\node_modules\\css-loader\\dist\\cjs.js","mtime":1577118249893},{"path":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1577118252216},{"path":"D:\\Learn\\blog-person\\node_modules\\postcss-loader\\src\\index.js","mtime":1572976729857},{"path":"D:\\Learn\\blog-person\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572976728968},{"path":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js","mtime":1577118252216}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaDQgewogICAgZm9udC1zaXplOiAxNnB4OwogICAgZm9udC13ZWlnaHQ6IGJvbGQ7Cn0KCi5lbC10aW1lbGluZSB7CiAgICBwYWRkaW5nOiAxMHB4Owp9CgouY29sbC10aXRsZSB7CiAgICBmb250LXdlaWdodDogYm9sZDsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIGNvbG9yOiM0MDlFRkY7Cn0KCi5lbC1pY29uLWRlbGV0ZSB7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5lbC1pY29uLWRlbGV0ZTpob3ZlciB7CiAgICBjb2xvcjogIzQwOUVGRjsKfQoubGluay10aXRsZXsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHdpZHRoOiAxMDAlOwogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogICAgb3ZlcmZsb3cteDogaGlkZGVuOwogICAgcGFkZGluZy1yaWdodDogMTBweDsKfQoKLmxpbmstdGl0bGU6aG92ZXIgewogICAgY29sb3I6ICM0MDlFRkY7CiAgICBjdXJzb3I6IHBvaW50ZXI7Cn0KCi5saW5rLXRpdGxlIHsKICAgIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICAgIHdpZHRoOiAzMjBweDsKfQoubGluay13aWQgewogICAgd2lkdGg6IDUwJTsKfQouZWwtaWNvbi1kZWxldGUgewogICAgdmVydGljYWwtYWxpZ246IHN1cGVyOwp9Cg=="},{"version":3,"sources":["TimeLine.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuIA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TimeLine.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <el-card class=\"box-card\">\r\n        <el-collapse accordion v-model=\"activeYear\">\r\n            <el-collapse-item v-for=\"(year, i) in yearList\" :name=\"year\" :key=\"i\" :id=\"'_' + year\">\r\n                <template slot=\"title\">\r\n                    <p class=\"coll-title\">{{ year }}年</p>\r\n                </template>\r\n                <el-timeline>\r\n                    <el-timeline-item\r\n                            color=\"rgb(127, 185, 245)\"\r\n                            v-for=\"item in timeline\"\r\n                            :key=\"item.id\"\r\n                            :timestamp=\"item.ctime\"\r\n                            v-if=\"item.year == year\">\r\n                        <div @click=\"readArticle($event)\" :data-id=\"item.id\" class=\"link-title\" :class=\"{'link-wid': phone}\" :title=\"item.title\">\r\n                            {{ item.title }}\r\n                        </div>\r\n                        <i class=\"el-icon-delete\" title=\"删除\" v-if=\"isLogin\" :data-info=\"item.id\" @click=\"del($event)\"/>\r\n                    </el-timeline-item>\r\n                </el-timeline>\r\n            </el-collapse-item>\r\n        </el-collapse>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import {mapState, mapGetters} from \"vuex\"\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                timeline: []\r\n            };\r\n        },\r\n        methods: {\r\n             del (e) {\r\n                /*点击每条时都会带有渲染时的ID,根据ID删除文章*/\r\n                const id = e.target.getAttribute(\"data-info\");\r\n                this.$confirm('确定删除本条记录吗?', '温馨提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(async () => {\r\n                    try {\r\n                        await this.deleteBlog(id);\r\n                        this.$message.warning('本篇文章已删除!');\r\n                        this.timeline.forEach((ele, index) => { // 更新当前视图\r\n                            if (ele.id == id) {\r\n                                this.timeline.splice(index,  1);\r\n                            }\r\n                        }, this);\r\n                        this.$listeners[\"refreshHome\"](); //更新首页右侧区域内容\r\n                    }catch (e) {\r\n                        console.log(e)\r\n                    }\r\n                }).catch(() => {\r\n                    this.$message.info('已取消');\r\n                });\r\n            },\r\n            readArticle (e) {\r\n                let id = e.target.getAttribute(\"data-id\");\r\n                this.$router.push({\r\n                    name: 'blogDetail',\r\n                    params: {\r\n                        id\r\n                    }\r\n                });\r\n            },\r\n            deleteBlog(id) {\r\n                return this.axios({\r\n                    method: 'post',\r\n                    url: '/deleteBlog',\r\n                    data: {\r\n                        id\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        computed: {\r\n            /*...mapState({\r\n                yearList: state => state.time.yearList  // 无论time是否加命名空间,此写法都可以\r\n            }),*/\r\n            ...mapState(\"time\", [\"yearList\", \"currentChoose\"]),\r\n            ...mapState([\"isLogin\"]),\r\n            ...mapGetters(\"time\", [\"currentYear\"]),\r\n            ...mapGetters({\r\n                phone: \"getDeviceIsPhone\"\r\n            }),\r\n            activeYear: {\r\n                set(val) {\r\n                    this.$store.commit(\"time/setCurrentChoose\", val);\r\n                },\r\n                get () {\r\n                    return this.currentChoose || this.currentYear\r\n                }\r\n            }\r\n        },\r\n        beforeCreate() {\r\n            const store = this.$store;\r\n            /*\r\n            *  请求文章列表信息\r\n            * */\r\n            this.axios({\r\n                url: '/getArticleList'\r\n            }).then(res => {\r\n                let newArr = [];\r\n                let newObj = {};\r\n                res.data.forEach(ele => {\r\n                    let year = new Date(ele.ctime).getFullYear().toString();\r\n                    if(!newObj[year]){\r\n                        newObj[year] = true;\r\n                        newArr.push(year);\r\n                    }\r\n                });\r\n                store.commit(\"time/getYearList\", newArr);\r\n                res.data.forEach(ele=>{\r\n                    let ctime = ele.ctime;\r\n                    ele.ctime = this.$date_format(ctime);\r\n                    ele.year = new Date(ctime).getFullYear();\r\n                    this.timeline.push(ele);\r\n                });\r\n            }).catch(err => {\r\n                console.log(err)\r\n            })\r\n        },\r\n        created() {\r\n            this.$store.commit(\"setLeftTagsLine\", {\r\n                lineList: !this.phone,\r\n                leftCol: this.phone ? 24 : 16\r\n            });\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    h4 {\r\n        font-size: 16px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .el-timeline {\r\n        padding: 10px;\r\n    }\r\n\r\n    .coll-title {\r\n        font-weight: bold;\r\n        font-size: 18px;\r\n        color:#409EFF;\r\n    }\r\n\r\n    .el-icon-delete {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .el-icon-delete:hover {\r\n        color: #409EFF;\r\n    }\r\n    .link-title{\r\n        display: inline-block;\r\n        width: 100%;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n        overflow-x: hidden;\r\n        padding-right: 10px;\r\n    }\r\n\r\n    .link-title:hover {\r\n        color: #409EFF;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .link-title {\r\n        display: inline-block;\r\n        width: 320px;\r\n    }\r\n    .link-wid {\r\n        width: 50%;\r\n    }\r\n    .el-icon-delete {\r\n        vertical-align: super;\r\n    }\r\n</style>"]}]}