{"remainingRequest":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Learn\\blog-person\\src\\views\\TimeLine.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Learn\\blog-person\\src\\views\\TimeLine.vue","mtime":1578506982915},{"path":"D:\\Learn\\blog-person\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1572976728968},{"path":"D:\\Learn\\blog-person\\node_modules\\vue-loader\\lib\\index.js","mtime":1577118252216}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7bWFwU3RhdGUsIG1hcEdldHRlcnN9IGZyb20gInZ1ZXgiCgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRpbWVsaW5lOiBbXQogICAgICAgIH07CiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgICBkZWwgKGUpIHsKICAgICAgICAgICAgLyrngrnlh7vmr4/mnaHml7bpg73kvJrluKbmnInmuLLmn5Pml7bnmoRJRCzmoLnmja5JROWIoOmZpOaWh+eroCovCiAgICAgICAgICAgIGNvbnN0IGlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCJkYXRhLWluZm8iKTsKICAgICAgICAgICAgdGhpcy4kY29uZmlybSgn56Gu5a6a5Yig6Zmk5pys5p2h6K6w5b2V5ZCXPycsICfmuKnppqjmj5DnpLonLCB7CiAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgICAgICB9KS50aGVuKGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5kZWxldGVCbG9nKGlkKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ+acrOevh+aWh+eroOW3suWIoOmZpCEnKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVsaW5lLmZvckVhY2goKGVsZSwgaW5kZXgpID0+IHsgLy8g5pu05paw5b2T5YmN6KeG5Zu+CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbGUuaWQgPT0gaWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGltZWxpbmUuc3BsaWNlKGluZGV4LCAgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LCB0aGlzKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRsaXN0ZW5lcnNbInJlZnJlc2hIb21lIl0oKTsgLy/mm7TmlrDpppbpobXlj7PkvqfljLrln5/lhoXlrrkKICAgICAgICAgICAgICAgIH1jYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuaW5mbygn5bey5Y+W5raIJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgcmVhZEFydGljbGUgKGUpIHsKICAgICAgICAgICAgbGV0IGlkID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCJkYXRhLWlkIik7CiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgICAgIG5hbWU6ICdibG9nRGV0YWlsJywKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIGlkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZGVsZXRlQmxvZyhpZCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5heGlvcyh7CiAgICAgICAgICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICAgICAgICAgIHVybDogJy9kZWxldGVCbG9nJywKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICBpZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9LAogICAgY29tcHV0ZWQ6IHsKICAgICAgICAvKi4uLm1hcFN0YXRlKHsKICAgICAgICAgICAgeWVhckxpc3Q6IHN0YXRlID0+IHN0YXRlLnRpbWUueWVhckxpc3QgIC8vIOaXoOiuunRpbWXmmK/lkKbliqDlkb3lkI3nqbrpl7Qs5q2k5YaZ5rOV6YO95Y+v5LulCiAgICAgICAgfSksKi8KICAgICAgICAuLi5tYXBTdGF0ZSgidGltZSIsIFsieWVhckxpc3QiLCAiY3VycmVudENob29zZSJdKSwKICAgICAgICAuLi5tYXBTdGF0ZShbImlzTG9naW4iXSksCiAgICAgICAgLi4ubWFwR2V0dGVycygidGltZSIsIFsiY3VycmVudFllYXIiXSksCiAgICAgICAgLi4ubWFwR2V0dGVycyh7CiAgICAgICAgICAgIHBob25lOiAiZ2V0RGV2aWNlSXNQaG9uZSIKICAgICAgICB9KSwKICAgICAgICBhY3RpdmVZZWFyOiB7CiAgICAgICAgICAgIHNldCh2YWwpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidGltZS9zZXRDdXJyZW50Q2hvb3NlIiwgdmFsKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2V0ICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRDaG9vc2UgfHwgdGhpcy5jdXJyZW50WWVhcgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIGJlZm9yZUNyZWF0ZSgpIHsKICAgICAgICBjb25zdCBzdG9yZSA9IHRoaXMuJHN0b3JlOwogICAgICAgIC8qCiAgICAgICAgKiAg6K+35rGC5paH56ug5YiX6KGo5L+h5oGvCiAgICAgICAgKiAqLwogICAgICAgIHRoaXMuYXhpb3MoewogICAgICAgICAgICB1cmw6ICcvZ2V0QXJ0aWNsZUxpc3QnCiAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICBsZXQgbmV3QXJyID0gW107CiAgICAgICAgICAgIGxldCBuZXdPYmogPSB7fTsKICAgICAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChlbGUgPT4gewogICAgICAgICAgICAgICAgbGV0IHllYXIgPSBuZXcgRGF0ZShlbGUuY3RpbWUpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIGlmKCFuZXdPYmpbeWVhcl0pewogICAgICAgICAgICAgICAgICAgIG5ld09ialt5ZWFyXSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgbmV3QXJyLnB1c2goeWVhcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBzdG9yZS5jb21taXQoInRpbWUvZ2V0WWVhckxpc3QiLCBuZXdBcnIpOwogICAgICAgICAgICByZXMuZGF0YS5mb3JFYWNoKGVsZT0+ewogICAgICAgICAgICAgICAgbGV0IGN0aW1lID0gZWxlLmN0aW1lOwogICAgICAgICAgICAgICAgZWxlLmN0aW1lID0gdGhpcy4kZGF0ZV9mb3JtYXQoY3RpbWUpOwogICAgICAgICAgICAgICAgZWxlLnllYXIgPSBuZXcgRGF0ZShjdGltZSkuZ2V0RnVsbFllYXIoKTsKICAgICAgICAgICAgICAgIHRoaXMudGltZWxpbmUucHVzaChlbGUpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgfSkKICAgIH0sCiAgICBjcmVhdGVkKCkgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0TGVmdFRhZ3NMaW5lIiwgewogICAgICAgICAgICBsaW5lTGlzdDogIXRoaXMucGhvbmUsCiAgICAgICAgICAgIGxlZnRDb2w6IHRoaXMucGhvbmUgPyAyNCA6IDE2CiAgICAgICAgfSk7CiAgICB9Cn07Cg=="},{"version":3,"sources":["TimeLine.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TimeLine.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <el-card class=\"box-card\">\r\n        <el-collapse accordion v-model=\"activeYear\">\r\n            <el-collapse-item v-for=\"(year, i) in yearList\" :name=\"year\" :key=\"i\" :id=\"'_' + year\">\r\n                <template slot=\"title\">\r\n                    <p class=\"coll-title\">{{ year }}年</p>\r\n                </template>\r\n                <el-timeline>\r\n                    <el-timeline-item\r\n                            color=\"rgb(127, 185, 245)\"\r\n                            v-for=\"item in timeline\"\r\n                            :key=\"item.id\"\r\n                            :timestamp=\"item.ctime\"\r\n                            v-if=\"item.year == year\">\r\n                        <div @click=\"readArticle($event)\" :data-id=\"item.id\" class=\"link-title\" :class=\"{'link-wid': phone}\" :title=\"item.title\">\r\n                            {{ item.title }}\r\n                        </div>\r\n                        <i class=\"el-icon-delete\" title=\"删除\" v-if=\"isLogin\" :data-info=\"item.id\" @click=\"del($event)\"/>\r\n                    </el-timeline-item>\r\n                </el-timeline>\r\n            </el-collapse-item>\r\n        </el-collapse>\r\n    </el-card>\r\n</template>\r\n\r\n<script>\r\n    import {mapState, mapGetters} from \"vuex\"\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n                timeline: []\r\n            };\r\n        },\r\n        methods: {\r\n             del (e) {\r\n                /*点击每条时都会带有渲染时的ID,根据ID删除文章*/\r\n                const id = e.target.getAttribute(\"data-info\");\r\n                this.$confirm('确定删除本条记录吗?', '温馨提示', {\r\n                    confirmButtonText: '确定',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning'\r\n                }).then(async () => {\r\n                    try {\r\n                        await this.deleteBlog(id);\r\n                        this.$message.warning('本篇文章已删除!');\r\n                        this.timeline.forEach((ele, index) => { // 更新当前视图\r\n                            if (ele.id == id) {\r\n                                this.timeline.splice(index,  1);\r\n                            }\r\n                        }, this);\r\n                        this.$listeners[\"refreshHome\"](); //更新首页右侧区域内容\r\n                    }catch (e) {\r\n                        console.log(e)\r\n                    }\r\n                }).catch(() => {\r\n                    this.$message.info('已取消');\r\n                });\r\n            },\r\n            readArticle (e) {\r\n                let id = e.target.getAttribute(\"data-id\");\r\n                this.$router.push({\r\n                    name: 'blogDetail',\r\n                    params: {\r\n                        id\r\n                    }\r\n                });\r\n            },\r\n            deleteBlog(id) {\r\n                return this.axios({\r\n                    method: 'post',\r\n                    url: '/deleteBlog',\r\n                    data: {\r\n                        id\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        computed: {\r\n            /*...mapState({\r\n                yearList: state => state.time.yearList  // 无论time是否加命名空间,此写法都可以\r\n            }),*/\r\n            ...mapState(\"time\", [\"yearList\", \"currentChoose\"]),\r\n            ...mapState([\"isLogin\"]),\r\n            ...mapGetters(\"time\", [\"currentYear\"]),\r\n            ...mapGetters({\r\n                phone: \"getDeviceIsPhone\"\r\n            }),\r\n            activeYear: {\r\n                set(val) {\r\n                    this.$store.commit(\"time/setCurrentChoose\", val);\r\n                },\r\n                get () {\r\n                    return this.currentChoose || this.currentYear\r\n                }\r\n            }\r\n        },\r\n        beforeCreate() {\r\n            const store = this.$store;\r\n            /*\r\n            *  请求文章列表信息\r\n            * */\r\n            this.axios({\r\n                url: '/getArticleList'\r\n            }).then(res => {\r\n                let newArr = [];\r\n                let newObj = {};\r\n                res.data.forEach(ele => {\r\n                    let year = new Date(ele.ctime).getFullYear().toString();\r\n                    if(!newObj[year]){\r\n                        newObj[year] = true;\r\n                        newArr.push(year);\r\n                    }\r\n                });\r\n                store.commit(\"time/getYearList\", newArr);\r\n                res.data.forEach(ele=>{\r\n                    let ctime = ele.ctime;\r\n                    ele.ctime = this.$date_format(ctime);\r\n                    ele.year = new Date(ctime).getFullYear();\r\n                    this.timeline.push(ele);\r\n                });\r\n            }).catch(err => {\r\n                console.log(err)\r\n            })\r\n        },\r\n        created() {\r\n            this.$store.commit(\"setLeftTagsLine\", {\r\n                lineList: !this.phone,\r\n                leftCol: this.phone ? 24 : 16\r\n            });\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped>\r\n    h4 {\r\n        font-size: 16px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .el-timeline {\r\n        padding: 10px;\r\n    }\r\n\r\n    .coll-title {\r\n        font-weight: bold;\r\n        font-size: 18px;\r\n        color:#409EFF;\r\n    }\r\n\r\n    .el-icon-delete {\r\n        cursor: pointer;\r\n    }\r\n\r\n    .el-icon-delete:hover {\r\n        color: #409EFF;\r\n    }\r\n    .link-title{\r\n        display: inline-block;\r\n        width: 100%;\r\n        white-space: nowrap;\r\n        text-overflow: ellipsis;\r\n        overflow-x: hidden;\r\n        padding-right: 10px;\r\n    }\r\n\r\n    .link-title:hover {\r\n        color: #409EFF;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .link-title {\r\n        display: inline-block;\r\n        width: 320px;\r\n    }\r\n    .link-wid {\r\n        width: 50%;\r\n    }\r\n    .el-icon-delete {\r\n        vertical-align: super;\r\n    }\r\n</style>"]}]}